name: pick-colour-picker
adopt-info: pick-colour-picker
summary: A colour picker that remembers where you picked colours from
description: |
  Choose the colour you want and Pick remembers it, names it, and shows you a screenshot
  so you can remember where you got it from. Zoom all the way in to pixels to pick
  just the right one. Show your colours in your choice of format: rgba() or hex,
  CSS or Gdk or Qt, whichever you prefer. Copy to the clipboard ready for pasting into
  code or graphics apps.
icon: pick-colour-picker.png

base: core22
grade: stable
confinement: strict

slots:
  pick-colour-picker-dbus:
    interface: dbus
    name: org.kryogenix.Pick
    bus: session

apps:
  pick-colour-picker:
    extensions: [ gnome ]
    command: bin/pick-colour-picker
    desktop: share/applications/pick-colour-picker.desktop
    plugs:
      - home

parts:
  pick-colour-picker:
    source: .
    plugin: python
    override-pull: |
      craftctl default
      sed -i 's|Icon=pick-colour-picker|Icon=${SNAP}/share/pixmaps/pick-colour-picker.png|g' pick-colour-picker.desktop
      VER=$(grep __VERSION__ pick/__main__.py | head -n 1 | cut -d'=' -f2 | sed 's/ //g' | sed "s/\"//g")
      REV=$(git rev-parse --short HEAD)
      craftctl set version=$(echo $VER-$REV)
    # Most of what Pick requires is provided by the GNOME platform snap; so just prime what we need.
    prime:
      - bin
      - lib
      - share/applications/pick-colour-picker.desktop
      - share/icons/hicolor/*/apps/pick-colour-picker.png
      - share/icons/hicolor/*/apps/pick-colour-picker-symbolic.svg
      - share/pixmaps/pick-colour-picker.png
